<link rel="import" href="bower_components/polymer/polymer.html">
<link rel="import" href="bower_components/iron-flex-layout/iron-flex-layout-classes.html">
<link rel="import" href="bower_components/iron-pages/iron-pages.html">
<link rel="import" href="bower_components/paper-tabs/paper-tabs.html">
<link rel="import" href="bower_components/paper-card/paper-card.html">

<link rel="import" href="poly-me-section.html">

<link rel="stylesheet" href="bower_components/components-font-awesome/css/font-awesome.min.css">


<!--
`poly-me`

A web based resume using polymer. You can add your information in a .json file
and link to it as follows:

Example:
```
  <poly-me src="john.json"></poly-me>
```

The `.json` file structure should be as follows:

```
{
  "content": {
    "name": "Your name",
    "profileImage": "path to profile image",
    "backgroundImage": "path to background image",
    "position": "Your position or title",
    "location": "Your location",
    "social": {
      "title": "a title to the social section underneath the profile info",
      "profiles": [
        {
          "network": "the icon name from the font awesome cheatsheet see http://fontawesome.io/icons/#brand",
          "link": "the link to go to when clicked"
        },...
      ]
    },
    "sections": [
      {
        "title": "The section title that will appear as the tab name and section header",
        "type": "The type of section to display",
        "content": "The content text to display before the cards or main content",
        "sections": [
          {
            "title": "The title of each section listed in the tab",
            "image": "The path to the image displauyed in each subsection",
            "content": "The text content of each subsection"
          },...
        ]
      },
      {
        "title": "Contact",
        "type": "contact",
        "content": "This is a section heading before the cards",
        "email": "sbeleidy90@gmail.com",
        "subject": "Poly-me contact form submission"
      }
    ]
  },
  "settings": {
    "primaryColor": "The hex value of the primary color for the app - use something close to the background image colors"
  }
  
}
```

Available section types are:

- content - basic content
- card - same as content but shown as cards
- contact - will show a contact form that uses formspree.io to send you an email
    - `email` - the email to send the message to
    - `subject` - the subject of the email that gets sent


@demo demo/index.html 
-->

<dom-module id="poly-me">
  <template>
    <style include="iron-flex iron-flex-alignment">
      :host {
        display: block;
        margin: 0;
        font-family: 'Roboto', 'Noto', sans-serif;
        line-height: 1.5;
        --paper-tabs-selection-bar-color: red;
      }

      .center-div {
        padding: 30px;
      }

      .profile {
        display: block;
        min-width: 200px;
        max-width: 350px;
        text-align: center;
        margin: 0 auto;
        padding: 20px;
      }

      .profile .name {
        font-size: 22px;
        padding: 8px 0;
      }

      .profile .position, .profile .location {
        font-size: 12px;
      }

      .location a {
        text-decoration: none;
      }

      .profile-image {
        width: 50px;
        height: 50px;
        border-radius: 25px;
      }

      .social-profiles a{
        text-decoration: none;
        color: black;
        margin: 10px;
      }

      paper-tabs {
        margin: 0px auto;
        max-width: 600px;
      }

      paper-tab {
        margin: auto;
      }

      .tabs-div, .center-div {
        background-color: var(--primary-color, darkblue);
      }

      .center-div {
        background-size: cover;
        background-image: var(--bg-image);
      }
    </style>

    <div class="center-div">
      <!--Center content-->
      <paper-card class="profile">
        <div>
          <img src$="{{data.profileImage}}" alt$="{{data.name}}" class="profile-image">
        </div>
        <div class="name">
          {{data.name}}
        </div>
        <div class="position">
          {{data.position}}
        </div>
        <div class="location">
            <a href$="https://google.com/maps/search/{{data.location}}" target="blank"><i class="fa fa-map-marker"></i> {{data.location}}</a>
          </div>
        <hr>
        <div class="social">
          <div class="social-title">
            {{data.social.title}}
          </div>
          <div class="social-profiles">
            <template is="dom-repeat" items="{{data.social.profiles}}">
              <a href$="{{item.link}}" target="_blank">
                <i class$="fa fa-{{item.network}}"></i>
              </a>
            </template>
          </div>
        </div>
      </paper-card>
    </div>

    <div class="tabs-div">
      <paper-tabs selected="{{selected}}" scrollable>
        <template is="dom-repeat" items="{{data.sections}}">
          <paper-tab>{{item.title}}</paper-tab>
        </template>
      </paper-tabs>
    </div>

    <div>
      <iron-pages selected="{{selected}}">
        <template is="dom-repeat" items="{{data.sections}}" as="section">
          <poly-me-section data="{{section}}"></poly-me-section>
        </template>
      </iron-pages>

    </div>

  </template>

  <script>
    Polymer({

      is: 'poly-me',

      properties: {
        /**
         * The path to the json file with the profile data
         */
        src: {
          type: String
        }
      },

      attached: function(){
        this.selected = 0;
        var self = this;
        this.data = fetch(this.src).then(function(res){
          return res.json();
        }).then(function(json){
          self.data = json.content;

          self.customStyle['--primary-color'] = json.settings.primaryColor == null ? 'blue' : json.settings.primaryColor;
          self.customStyle['--bg-image'] = "url('"+json.content.backgroundImage + "')";
          self.customStyle['--paper-tabs-selection-bar-color'] = json.settings.primaryColor == null ? 'green' : json.settings.tabBarColor;
          self.updateStyles();

        });
      }

    });
  </script>
</dom-module>
